<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@manticorp/ultraloot</title><meta name="description" content="Documentation for @manticorp/ultraloot"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@manticorp/ultraloot</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>@manticorp/ultraloot</h2></div><div class="tsd-panel tsd-typography"><a id="md:ultraloot" class="tsd-anchor"></a><h1 class="tsd-anchor-link">UltraLoot<a href="#md:ultraloot" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>An easy to use, extendable, serialisable loot table module</p>
<p>✅ Use in browser<br>
✅ Use in node project</p>
<p>✅ Plug and play<br>
✅ Tables can be stored as JSON file(s)<br>
✅ Flexible inheritance structure - great for large games<br>
✅ Seedable random number generator<br>
✅ Testable (RNG is injectable for predictable results)<br>
✅ Pluggable Functions and Conditions<br>
✅ Looter / Container context functions - allows you to modify loot depending on who looted from where</p>
<p>🏎️ Fast<br>
📝 Written in typescript<br>
📈 Jest unit tests with high coverage<br>
📫 Sync and Async versions (async default, to allow for async conditions/functions)<br>
🏠 Many examples</p>
<ul>
<li><a href="https://manticorp.github.io/ultraloot" target="_blank" class="external">Advanced Docs</a></li>
<li><a href="https://manticorp.github.io/ultraloot/examples" target="_blank" class="external">Examples</a></li>
<li><a href="https://manticorp.github.io/ultraloot/code/" target="_blank" class="external">Code Docs</a></li>
</ul>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Run <code>npm install @manticorp/ultraloot</code> or include the dist file in browser.</p>
<a id="md:browser" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Browser<a href="#md:browser" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Download release and include ultraloot in browser:</p>
<pre><code class="html"><span class="hl-0">&lt;</span><span class="hl-1">script</span><span class="hl-2"> </span><span class="hl-3">src</span><span class="hl-2">=</span><span class="hl-4">&quot;dist/ultraloot.js&quot;</span><span class="hl-0">&gt;&lt;/</span><span class="hl-1">script</span><span class="hl-0">&gt;</span><br/><span class="hl-0">&lt;</span><span class="hl-1">script</span><span class="hl-0">&gt;</span><br/><span class="hl-5">const</span><span class="hl-2"> </span><span class="hl-6">ul</span><span class="hl-2"> </span><span class="hl-7">=</span><span class="hl-2"> </span><span class="hl-5">new</span><span class="hl-2"> </span><span class="hl-8">UltraLoot</span><span class="hl-2">();</span><br/><span class="hl-0">&lt;/</span><span class="hl-1">script</span><span class="hl-0">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="md:node" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Node<a href="#md:node" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> { </span><span class="hl-6">UltraLoot</span><span class="hl-7"> } = </span><span class="hl-8">require</span><span class="hl-7">(</span><span class="hl-9">&#39;@manticorp/ultraLoot&#39;</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:es-module" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ES Module<a href="#md:es-module" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-10">import</span><span class="hl-7"> </span><span class="hl-11">UltraLoot</span><span class="hl-7"> </span><span class="hl-10">from</span><span class="hl-7"> </span><span class="hl-9">&#39;@manticorp/ultraLoot&#39;</span><span class="hl-7">;</span>
</code><button type="button">Copy</button></pre>

<a id="md:use-cases" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Use cases<a href="#md:use-cases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>✅ Loot boxes<br>
✅ Mob drops<br>
✅ Random events<br>
✅ Mob spawning<br>
✅ Quest rewards<br>
✅ And more!</p>
<a id="md:preface" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Preface<a href="#md:preface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The aim of this module is to provide a highly flexible loot table implementation that allows for inheritance and modifying results based on context (e.g. the looter, where the loot is coming from, and the other results of rolling the table).</p>
<p>Imagine you're building a mining game.</p>
<p>The loot generated depends on what tool the player was mining with. If they mine with a <strong>stone</strong> axe, they can only mine <strong>stone</strong>. If they mine with a <strong>diamond</strong> axe, they might get <strong>diamonds</strong>.</p>
<pre><code class="javascript"><span class="hl-12">// Prep the tables</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">miningTable</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;mining&#39;</span><span class="hl-7">);</span><br/><br/><span class="hl-12">// Looters in your app</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">weakLooter</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">Player</span><span class="hl-7">().</span><span class="hl-8">equip</span><span class="hl-7">({</span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;axe&#39;</span><span class="hl-7">, </span><span class="hl-11">level:</span><span class="hl-7"> </span><span class="hl-9">&#39;stone&#39;</span><span class="hl-7">});</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">strongLooter</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">Player</span><span class="hl-7">().</span><span class="hl-8">equip</span><span class="hl-7">({</span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;axe&#39;</span><span class="hl-7">, </span><span class="hl-11">level:</span><span class="hl-7"> </span><span class="hl-9">&#39;diamond&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// Do some mining/rolling</span><br/><span class="hl-11">miningTable</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">({</span><span class="hl-11">looter:</span><span class="hl-7"> </span><span class="hl-11">weakLooter</span><span class="hl-7">}).</span><span class="hl-8">then</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7"> </span><span class="hl-5">=&gt;</span><span class="hl-7"> </span><span class="hl-11">weakLooter</span><span class="hl-7">.</span><span class="hl-8">addInventory</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7">));</span><br/><span class="hl-12">// [{id: &#39;stone&#39;, qty: 1}]</span><br/><br/><span class="hl-11">miningTable</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">({</span><span class="hl-11">looter:</span><span class="hl-7"> </span><span class="hl-11">strongLooter</span><span class="hl-7">}).</span><span class="hl-8">then</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7"> </span><span class="hl-5">=&gt;</span><span class="hl-7"> </span><span class="hl-11">strongLooter</span><span class="hl-7">.</span><span class="hl-8">addInventory</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7">));</span><br/><span class="hl-12">// [{id: &#39;stone&#39;, qty: 3}, {id: &#39;ruby&#39;, qty: 2}, {id: &#39;diamond&#39;, qty: 1}]</span>
</code><button type="button">Copy</button></pre>

<p>The way the tables are structured allows for easy inheritence and storage in JSON files as well, with a default loading mechanism already in place.</p>
<a id="md:structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Structure<a href="#md:structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>There is a hierarchy:</p>
<ul>
<li><strong>Loot Tables</strong> contain multiple <strong>Pools</strong></li>
<li><strong>Pools</strong> contain multiple <strong>Entries</strong></li>
<li>Each <strong>Entry</strong> can in turn be another <strong>Loot Table</strong>, or a plain <strong>Item</strong></li>
</ul>
<p>Items marked <strong><code>Chancy</code></strong> have a special meaning.</p>
<p>Here is a full table definition for illustration, although please view type information for <a href="https://manticorp.github.io/ultraloot/code/types/index.LootTableEasyDefinition.html" target="_blank" class="external">LootTableEasyDefinition</a> for more information:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">tableDefinition</span><span class="hl-7"> = {</span><br/><span class="hl-7">  </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&#39;Table Name&#39;</span><span class="hl-7">,  </span><span class="hl-12">// optional - for your convenience, not required</span><br/><span class="hl-7">  </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;table_id&#39;</span><span class="hl-7">,      </span><span class="hl-12">// optional - for your convenience, not required</span><br/><span class="hl-7">  </span><span class="hl-11">fn:</span><span class="hl-7"> </span><span class="hl-9">&#39;filename&#39;</span><span class="hl-7">,      </span><span class="hl-12">// optional - used to let ul know what the filename for this table is -</span><br/><span class="hl-7">                       </span><span class="hl-12">//            used in un/serialization and loading/saving</span><br/><span class="hl-7">  </span><span class="hl-11">rng:</span><span class="hl-7"> </span><span class="hl-11">RngInterface</span><span class="hl-7">,   </span><span class="hl-12">// optional - RNG to be used by this loot table</span><br/><span class="hl-7">  </span><span class="hl-11">ul:</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">,       </span><span class="hl-12">// optional - ul instance - only needed when creating loot tables</span><br/><span class="hl-7">                       </span><span class="hl-12">//            directly via new LootTable() and not ul.createTable().</span><br/><span class="hl-7">                       </span><span class="hl-12">//            This allows inheritance of functions and conditions</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [{</span><br/><span class="hl-7">    </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&#39;Pool Name&#39;</span><span class="hl-7">, </span><span class="hl-12">// optional - for your convenience, not required</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;pool_id&#39;</span><span class="hl-7">,     </span><span class="hl-12">// optional - for your convenience, not required</span><br/><span class="hl-7">    </span><span class="hl-11">rolls:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,          </span><span class="hl-12">// optional - Chancy - default 1 - number of rolls this pool gets when the table is rolled once</span><br/><span class="hl-7">    </span><span class="hl-11">nulls:</span><span class="hl-7"> </span><span class="hl-13">0</span><span class="hl-7">,          </span><span class="hl-12">// optional - Chancy - default 0 - alongside entries, null result will appear with this weight.</span><br/><span class="hl-7">    </span><span class="hl-11">conditions:</span><span class="hl-7"> [      </span><span class="hl-12">// optional - an array of conditions that should be called when this pool is rolled.</span><br/><span class="hl-7">                       </span><span class="hl-12">//            If any condition returns false, no result is returned for that pool (all rolls).</span><br/><span class="hl-7">      {</span><br/><span class="hl-7">        </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;condition_name&#39;</span><span class="hl-7">, </span><span class="hl-12">// required - the name of the condition</span><br/><span class="hl-7">        </span><span class="hl-11">arguments:</span><span class="hl-7"> {                </span><span class="hl-12">// optional - arguments passed to the &quot;args&quot; named parameter of the function.</span><br/><span class="hl-7">          </span><span class="hl-11">foo:</span><span class="hl-7"> </span><span class="hl-9">&#39;bar&#39;</span><span class="hl-7">                </span><span class="hl-12">//            This can be anything you like.</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      }</span><br/><span class="hl-7">    ],</span><br/><span class="hl-7">    </span><span class="hl-11">functions:</span><span class="hl-7"> [       </span><span class="hl-12">// optional - functions that are applied to every entry result.</span><br/><span class="hl-7">      {</span><br/><span class="hl-7">        </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;function_name&#39;</span><span class="hl-7">, </span><span class="hl-12">// required - the name of the function</span><br/><span class="hl-7">        </span><span class="hl-11">arguments:</span><span class="hl-7"> {               </span><span class="hl-12">// optional - arguments passed to the &quot;args&quot; named parameter of the function.</span><br/><span class="hl-7">          </span><span class="hl-11">foo:</span><span class="hl-7"> </span><span class="hl-9">&#39;bar&#39;</span><span class="hl-7">               </span><span class="hl-12">//            This can be anything you like.</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      }</span><br/><span class="hl-7">    ],</span><br/><span class="hl-7">    </span><span class="hl-11">template:</span><span class="hl-7"> {        </span><span class="hl-12">// optional - a template entry from which all entries will inherit. Useful for very samey pools</span><br/><span class="hl-7">                       </span><span class="hl-12">//            has the same structure as entries, below</span><br/><span class="hl-7">    },</span><br/><span class="hl-7">    </span><span class="hl-11">entries:</span><span class="hl-7"> [</span><br/><span class="hl-7">      {</span><br/><span class="hl-7">        </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&#39;Entry Name&#39;</span><span class="hl-7">, </span><span class="hl-12">// optional - for your convenience, not required</span><br/><span class="hl-7">        </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;entry_id&#39;</span><span class="hl-7">,     </span><span class="hl-12">// optional - for your convenience, not required (though highly recommended)</span><br/><span class="hl-7">        </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,    </span><span class="hl-12">// optional - default true - whether this item stacks (multiple results get added together) or not</span><br/><span class="hl-7">        </span><span class="hl-11">unique:</span><span class="hl-7"> </span><span class="hl-5">false</span><span class="hl-7">,      </span><span class="hl-12">// optional - default false - if true, this item will only appear once when this pool is rolled</span><br/><span class="hl-7">        </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,          </span><span class="hl-12">// optional - Chancy - default 1 - the relative weight of this entry compared to others</span><br/><span class="hl-7">        </span><span class="hl-11">item:</span><span class="hl-7"> {},           </span><span class="hl-12">// optional - anything, used for your convenience. If this is a loot table, then it will be</span><br/><span class="hl-7">                            </span><span class="hl-12">//            rolled and the results merged with the parent table results.</span><br/><span class="hl-7">        </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,             </span><span class="hl-12">// optional - Chancy - default 1 - the qty of this item to return</span><br/><span class="hl-7">        </span><span class="hl-11">conditions:</span><span class="hl-7"> [       </span><span class="hl-12">// optional - an array of conditions that should be called when this entry is rolled.</span><br/><span class="hl-7">                            </span><span class="hl-12">//            If any condition returns false, no result is returned for that entry.</span><br/><span class="hl-7">          {</span><br/><span class="hl-7">            </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;condition_name&#39;</span><span class="hl-7">, </span><span class="hl-12">// required - the name of the condition</span><br/><span class="hl-7">            </span><span class="hl-11">arguments:</span><span class="hl-7"> {                </span><span class="hl-12">// optional - arguments passed to the &quot;args&quot; named parameter of the function.</span><br/><span class="hl-7">              </span><span class="hl-11">foo:</span><span class="hl-7"> </span><span class="hl-9">&#39;bar&#39;</span><span class="hl-7">                </span><span class="hl-12">//            This can be anything you like.</span><br/><span class="hl-7">            }</span><br/><span class="hl-7">          }</span><br/><span class="hl-7">        ],</span><br/><span class="hl-7">        </span><span class="hl-11">functions:</span><span class="hl-7"> [        </span><span class="hl-12">// optional - functions that are applied to every entry result.</span><br/><span class="hl-7">          {</span><br/><span class="hl-7">            </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;function_name&#39;</span><span class="hl-7">, </span><span class="hl-12">// required - the name of the function</span><br/><span class="hl-7">            </span><span class="hl-11">arguments:</span><span class="hl-7"> {               </span><span class="hl-12">// optional - arguments passed to the &quot;args&quot; named parameter of the function.</span><br/><span class="hl-7">              </span><span class="hl-11">foo:</span><span class="hl-7"> </span><span class="hl-9">&#39;bar&#39;</span><span class="hl-7">               </span><span class="hl-12">//            This can be anything you like.</span><br/><span class="hl-7">            }</span><br/><span class="hl-7">          }</span><br/><span class="hl-7">        ]</span><br/><span class="hl-7">      }</span><br/><span class="hl-7">    ]</span><br/><span class="hl-7">  }]</span><br/><span class="hl-7">};</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">table</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">(</span><span class="hl-11">tableDefinition</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<p>The absolute most basic example you could possibly have is:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">emptyTable</span><span class="hl-7"> = </span><span class="hl-11">u</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">({});</span><br/><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">tableWithOneEmptyPool</span><span class="hl-7"> = </span><span class="hl-11">u</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">({</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [{}]</span><br/><span class="hl-7">});</span><br/><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">tableWithOnePoolWithTwoEmptyEntries</span><span class="hl-7"> = </span><span class="hl-11">u</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">({</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [</span><br/><span class="hl-7">    {</span><br/><span class="hl-7">      </span><span class="hl-11">entries:</span><span class="hl-7"> [</span><br/><span class="hl-7">        {},</span><br/><span class="hl-7">        {}</span><br/><span class="hl-7">      ]</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  ]</span><br/><span class="hl-7">});</span>
</code><button type="button">Copy</button></pre>

<p>See <a href="https://manticorp.github.io/ultraloot/code/classes/index.UltraLoot.html#createTable" target="_blank" class="external">UltraLoot.createTable</a> for more information.</p>
<a id="md:chancy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Chancy<a href="#md:chancy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Anything marked as &quot;Chancy&quot; is special, and can take one of the following as an argument:</p>
<ul>
<li>Number</li>
<li>Dice string / spec</li>
<li>Configuration object</li>
</ul>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">rng</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">getRng</span><span class="hl-7">();</span><br/><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">randomNumbers</span><span class="hl-7"> = [];</span><br/><br/><span class="hl-7"> </span><span class="hl-12">// Returns a simluated roll of 2 x 6 sided dice and adds 1</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">(</span><span class="hl-9">&#39;2d6 + 1&#39;</span><span class="hl-7">);</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">n:</span><span class="hl-7"> </span><span class="hl-13">2</span><span class="hl-7">, </span><span class="hl-11">d:</span><span class="hl-7"> </span><span class="hl-13">6</span><span class="hl-7">, </span><span class="hl-11">plus:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">});</span><br/><br/><span class="hl-7"> </span><span class="hl-12">// Always returns 5</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">(</span><span class="hl-13">5</span><span class="hl-7">);</span><br/><br/><span class="hl-12">// A random float between 1 and 10</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">min:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">max:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">});</span><br/><br/><span class="hl-7"> </span><span class="hl-12">// A random integer between 1 and 10</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">min:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">max:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;integer&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number between 1 and 10</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">min:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">max:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number centered at 0.5</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">mean:</span><span class="hl-7"> </span><span class="hl-13">0.5</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number centered at 10 with a standard deviation of 5</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">mean:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">stddev:</span><span class="hl-7"> </span><span class="hl-13">5</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number centered at 10 with a standard deviation of 5, skewed a bit to the left</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">mean:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">stddev:</span><span class="hl-7"> </span><span class="hl-13">5</span><span class="hl-7">, </span><span class="hl-11">skew:</span><span class="hl-7"> -</span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number centered at 10 with a standard deviation of 5, skewed a bit to the right</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">mean:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">stddev:</span><span class="hl-7"> </span><span class="hl-13">5</span><span class="hl-7">, </span><span class="hl-11">skew:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal&#39;</span><span class="hl-7">});</span><br/><br/><span class="hl-12">// A random normal number centered at 10 with a standard deviation of 5, rounded down to an integer (also accepts skew)</span><br/><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chancy</span><span class="hl-7">({</span><span class="hl-11">mean:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-11">stddev:</span><span class="hl-7"> </span><span class="hl-13">5</span><span class="hl-7">, </span><span class="hl-11">type:</span><span class="hl-7"> </span><span class="hl-9">&#39;normal_integer&#39;</span><span class="hl-7">});</span>
</code><button type="button">Copy</button></pre>

<p>As you can see, it's quite flexible, and allows for many ways of specifying chances in your loot tables.</p>
<p>The <code>rng</code> object is also passed to any functions or conditions on tables, so you can use chancy stuff there as well.</p>
<p><a href="https://manticorp.github.io/ultraloot/code/types/index.Chancy.html" target="_blank" class="external">You can find more information about Chancy here.</a></p>
<a id="md:usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#md:usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="https://manticorp.github.io/ultraloot/code/classes/index.LootTable.html#roll" target="_blank" class="external">You can find the documentation for rolling here</a>. Particularly, the <a href="https://manticorp.github.io/ultraloot/code/interfaces/index.TableRollInterface.html" target="_blank" class="external">arguments to the roll function, which are passed as ab object</a>.</p>
<p>Here is a simple example:</p>
<pre><code class="javascript"><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">definition</span><span class="hl-7"> = {</span><br/><span class="hl-7">  </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&#39;Precious Metals&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;precious_metals&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [</span><br/><span class="hl-7">    {</span><br/><span class="hl-7">      </span><span class="hl-11">rolls:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">      </span><span class="hl-11">nulls:</span><span class="hl-7"> </span><span class="hl-13">0</span><span class="hl-7">,</span><br/><span class="hl-7">      </span><span class="hl-11">entries:</span><span class="hl-7"> [</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">name:</span><span class="hl-7">  </span><span class="hl-9">&#39;Gold&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7">    </span><span class="hl-9">&#39;gold&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">        },</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">name:</span><span class="hl-7">  </span><span class="hl-9">&#39;Silver&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7">    </span><span class="hl-9">&#39;silver&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">2</span><span class="hl-7">,</span><br/><span class="hl-7">        },</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">name:</span><span class="hl-7">  </span><span class="hl-9">&#39;Bronze&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7">    </span><span class="hl-9">&#39;bronze&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">4</span><span class="hl-7">,</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      ]</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  ],</span><br/><span class="hl-7">};</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">preciousMetalsTable</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">(</span><span class="hl-11">definition</span><span class="hl-7">);</span><br/><br/><span class="hl-11">preciousMetalsTable</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">().</span><span class="hl-8">then</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7"> </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-11">console</span><span class="hl-7">.</span><span class="hl-8">log</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7">.</span><span class="hl-11">length</span><span class="hl-7">); </span><span class="hl-12">// 1</span><br/><span class="hl-7">  </span><span class="hl-11">console</span><span class="hl-7">.</span><span class="hl-8">log</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7">[</span><span class="hl-13">0</span><span class="hl-7">].</span><span class="hl-11">id</span><span class="hl-7">);  </span><span class="hl-12">// most likely bronze, but maybe silver or gold  </span><br/><span class="hl-7">});</span><br/>
</code><button type="button">Copy</button></pre>

<a id="md:simple" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Simple<a href="#md:simple" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The first thing you'll need to do is <a href="https://manticorp.github.io/ultraloot/code/classes/index.UltraLoot.html#constructor" target="_blank" class="external">create an UltraLoot instance</a>:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span>
</code><button type="button">Copy</button></pre>

<p>If you would like, you can pass in a <a href="https://manticorp.github.io/ultraloot/code/types/index.Seed.html" target="_blank" class="external">seed</a> for the <a href="https://manticorp.github.io/ultraloot/code/classes/index.Rng.html#constructor" target="_blank" class="external">random number generator</a>:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">(</span><span class="hl-9">&#39;my_awesome_seed&#39;</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<p>This allows you to get consistent results given the same seed.</p>
<p>You can also pass in your own random number generator, as long as it has certain functionality. This can be seen in <code>src/rng.ts</code> with the interface <a href="https://manticorp.github.io/ultraloot/code/interfaces/index.RngInterface.html" target="_blank" class="external">RngInterface</a> and <a href="https://manticorp.github.io/ultraloot/code/interfaces/index.RngConstructor.html" target="_blank" class="external">RngConstructor</a>.</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">(</span><span class="hl-11">myRngImplementation</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<p>Loot tables can be created with a call to <a href="https://manticorp.github.io/ultraloot/code/classes/index.UltraLoot.html#createTable" target="_blank" class="external">createTable</a>:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">table</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">(</span><span class="hl-11">tableDefinition</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<p>Then, to roll against the loot table, you can use the <code>roll</code> function</p>
<pre><code class="javascript"><br/><span class="hl-12">// player and monster are defined elsewhere in your application, and are</span><br/><span class="hl-12">// passed to functions / conditions to allow you to apply additional contextual</span><br/><span class="hl-12">// results depending on these arguments.</span><br/><span class="hl-11">table</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">({</span><br/><span class="hl-7">  </span><span class="hl-11">n:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">looter:</span><span class="hl-7"> </span><span class="hl-11">player</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">context:</span><span class="hl-7"> </span><span class="hl-11">monster</span><br/><span class="hl-7">}).</span><span class="hl-8">then</span><span class="hl-7">(</span><span class="hl-11">results</span><span class="hl-7"> </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">items</span><span class="hl-7"> = </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">convertLootTableResultsToItems</span><span class="hl-7">(</span><span class="hl-11">result</span><span class="hl-7">);</span><br/><span class="hl-7">  </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">scatterOnGround</span><span class="hl-7">(</span><span class="hl-11">items</span><span class="hl-7">, </span><span class="hl-11">monster</span><span class="hl-7">.</span><span class="hl-11">location</span><span class="hl-7">);</span><br/><span class="hl-7">});</span><br/><br/><span class="hl-12">// example using rollSync</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">result</span><span class="hl-7"> = </span><span class="hl-11">table</span><span class="hl-7">.</span><span class="hl-8">rollSync</span><span class="hl-7">({ </span><span class="hl-11">n :</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">looter:</span><span class="hl-7"> </span><span class="hl-11">player</span><span class="hl-7">, </span><span class="hl-11">context:</span><span class="hl-7"> </span><span class="hl-11">monster</span><span class="hl-7"> });</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">items</span><span class="hl-7"> = </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">convertLootTableResultsToItems</span><span class="hl-7">(</span><span class="hl-11">result</span><span class="hl-7">);</span><br/><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">scatterOnGround</span><span class="hl-7">(</span><span class="hl-11">items</span><span class="hl-7">, </span><span class="hl-11">monster</span><span class="hl-7">.</span><span class="hl-11">location</span><span class="hl-7">);</span><br/>
</code><button type="button">Copy</button></pre>

<a id="md:handing-results" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Handing Results<a href="#md:handing-results" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <a href="https://manticorp.github.io/ultraloot/code/classes/index.LootTableEntryResults.html" target="_blank" class="external">results</a> are given as a raw list of rolls from each pool in the table. This can, of course, consist of all the rolls of the sub table as well.</p>
<p>The result is a simple array of entries which mimic the entries created when the table was created:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">result</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">miningTable</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">();</span><br/><br/><span class="hl-11">result</span><span class="hl-7"> == [</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;gold&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&quot;Gold&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&quot;Silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;bronze&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&quot;Bronze&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">2</span><br/><span class="hl-7">  }</span><br/><span class="hl-7">];</span>
</code><button type="button">Copy</button></pre>

<p>Note that sometimes with multiple rolls you will get the same entry appearing multiple times. If you would like to consolidated them and add up their quantities, a handy <code>collapsed</code> function is available for you:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">result</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">miningTable</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">();</span><br/><br/><span class="hl-11">result</span><span class="hl-7"> == [</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;gold&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">false</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;gold&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">false</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">];</span><br/><br/><span class="hl-11">result</span><span class="hl-7">.</span><span class="hl-8">collapsed</span><span class="hl-7">() == [</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;gold&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">true</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">2</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">false</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&quot;silver&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">stackable:</span><span class="hl-7"> </span><span class="hl-5">false</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-11">qty:</span><span class="hl-7"> </span><span class="hl-13">1</span><br/><span class="hl-7">  },</span><br/><span class="hl-7">];</span>
</code><button type="button">Copy</button></pre>

<p>The <code>collapsed</code> function collapses things based on their JSON representation (minus the qty) so if their keys aren't exactly the same they won't be collapsed together.</p>
<p>Note: <code>collapsed</code> non-stackable entries don't necessarily have a qty of 1 depending on how your tables, pools and functions are set up. The collapse function doesn't split objects with a qty &gt; 1, it just doesn't add non stackable items together.</p>
<a id="md:sync-vs-async" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Sync vs Async<a href="#md:sync-vs-async" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>By default, rolling tables is a promise based async operation - this is to allow for asynchronous conditions and functions to be used.</p>
<p>If <strong>all</strong> of your functions/conditions are not asynchonous, you can use <code>rollSync</code> in place of <code>roll</code> everywhere it is used.</p>
<p>If you call <code>rollSync</code> and a condition returns a promise, you will get an error.</p>
<a id="md:loading-from-json-files" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Loading from JSON files<a href="#md:loading-from-json-files" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Loot tables can be stored in JSON files. The structure is the same as when creating them programatically, except for loot table entries inheriting from other tables.</p>
<p>Here is an example loot table json file <code>gems.json</code>:</p>
<pre><code class="json"><span class="hl-7">{</span><br/><span class="hl-7">    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Gems&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;gems&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">    </span><span class="hl-14">&quot;pools&quot;</span><span class="hl-7">: [</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">            </span><span class="hl-14">&quot;entries&quot;</span><span class="hl-7">: [</span><br/><span class="hl-7">                {</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;weight&quot;</span><span class="hl-7">: </span><span class="hl-13">0.1</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Diamond&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;diamond&quot;</span><br/><span class="hl-7">                },</span><br/><span class="hl-7">                {</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;weight&quot;</span><span class="hl-7">: </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Ruby&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;ruby&quot;</span><br/><span class="hl-7">                },</span><br/><span class="hl-7">                {</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;weight&quot;</span><span class="hl-7">: </span><span class="hl-13">10</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Emerald&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;emerald&quot;</span><br/><span class="hl-7">                },</span><br/><span class="hl-7">                {</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;weight&quot;</span><span class="hl-7">: </span><span class="hl-13">100</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Sapphire&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;sapphire&quot;</span><br/><span class="hl-7">                },</span><br/><span class="hl-7">                {</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;weight&quot;</span><span class="hl-7">: </span><span class="hl-13">1000</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;Amethyst&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">                    </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;amethyst&quot;</span><br/><span class="hl-7">                }</span><br/><span class="hl-7">            ]</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">    ]</span><br/><span class="hl-7">}</span>
</code><button type="button">Copy</button></pre>

<p>We would load this file like this - not it is an async process:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-11">table</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;gems.json&#39;</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<p>If you have a table with an entry that inherits from a table, then you need to provide it with a path and make sure it has the type &quot;table&quot;. For example, lets say we have <code>parent.json</code>:</p>
<pre><code class="json"><span class="hl-7">{</span><br/><span class="hl-7">  </span><span class="hl-14">&quot;name&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;My Super Loot Table&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-14">&quot;pools&quot;</span><span class="hl-7">: [</span><br/><span class="hl-7">    {</span><br/><span class="hl-7">      </span><span class="hl-14">&quot;entries&quot;</span><span class="hl-7">: [</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-14">&quot;type&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;item&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-14">&quot;id&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;regular_item&quot;</span><br/><span class="hl-7">        },</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-14">&quot;type&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;table&quot;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-14">&quot;item&quot;</span><span class="hl-7">: </span><span class="hl-9">&quot;path/to/sub/table&quot;</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      ]</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  ]</span><br/><span class="hl-7">}</span>
</code><button type="button">Copy</button></pre>

<p>The path to the sub table is relative to the path given when loading the table:</p>
<pre><code><span class="hl-11">path</span><br/><span class="hl-7">└── </span><span class="hl-11">to</span><br/><span class="hl-7">    └── </span><span class="hl-11">sub</span><br/><span class="hl-7">        └── </span><span class="hl-11">table</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-11">parent</span><span class="hl-7">.</span><span class="hl-11">json</span>
</code><button>Copy</button></pre>

<p>They can be located in a subfolder in your project - you will just need to provide a base path when calling <code>loadTable</code>:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">parent</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;parent.json&#39;</span><span class="hl-7">, {</span><span class="hl-11">path:</span><span class="hl-7"> </span><span class="hl-9">&#39;tables&#39;</span><span class="hl-7">});</span>
</code><button type="button">Copy</button></pre>

<p>This relative path will be applied to all sub tables as well.</p>
<p>You can also give a default extension to be used when no extensions are given:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">parent</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;parent&#39;</span><span class="hl-7">, {</span><span class="hl-11">path:</span><span class="hl-7"> </span><span class="hl-9">&#39;tables&#39;</span><span class="hl-7">, </span><span class="hl-11">defaultExtension:</span><span class="hl-7"> </span><span class="hl-9">&#39;.json&#39;</span><span class="hl-7">});</span>
</code><button type="button">Copy</button></pre>

<p>Example file structure found in <code>demo/tables</code>:</p>
<pre><code><span class="hl-11">tables</span><br/><span class="hl-7">├── </span><span class="hl-11">clothing</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">hats</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">shirts</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">shoes</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">trousers</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">food</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">composite</span><br/><span class="hl-7">│   │  ├── </span><span class="hl-11">fresh</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   │  └── </span><span class="hl-11">stable</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">baked</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">candy</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">chocolate</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">cooked</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">fruit</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">junk</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">pantry</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">vegetables</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">gear</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">armor</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">footwear</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">headgear</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">legwear</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">household</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">bathroom</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">bedroom</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">kitchen</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">living_room</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">loot</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">animal_generic</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">skill_books</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">skill_magazines</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">mining</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">gems</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">metals</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">stones</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">monsters</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">deer</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">vampire</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   ├── </span><span class="hl-11">werewolf</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">│   └── </span><span class="hl-11">zombie</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">armor_box</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">care_package</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">clothing_store</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">clothing</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">food</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">gear</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">kitchen_cupboard</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">├── </span><span class="hl-11">library_shelf</span><span class="hl-7">.</span><span class="hl-11">json</span><br/><span class="hl-7">└── </span><span class="hl-11">mining</span><span class="hl-7">.</span><span class="hl-11">json</span>
</code><button>Copy</button></pre>

<p>Then in your lootingGame.js:</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">tables</span><span class="hl-7"> = {};</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">options</span><span class="hl-7"> = {</span><span class="hl-11">path:</span><span class="hl-7"> </span><span class="hl-9">&#39;tables&#39;</span><span class="hl-7">, </span><span class="hl-11">defaultExtension:</span><span class="hl-7"> </span><span class="hl-9">&#39;.json&#39;</span><span class="hl-7">};</span><br/><br/><span class="hl-11">tables</span><span class="hl-7">.</span><span class="hl-11">clothing</span><span class="hl-7">     = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;clothing&#39;</span><span class="hl-7">, </span><span class="hl-11">options</span><span class="hl-7">);</span><br/><span class="hl-11">tables</span><span class="hl-7">.</span><span class="hl-11">libraryShelf</span><span class="hl-7"> = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;library_shelf&#39;</span><span class="hl-7">, </span><span class="hl-11">options</span><span class="hl-7">);</span><br/><span class="hl-11">tables</span><span class="hl-7">.</span><span class="hl-11">mining</span><span class="hl-7">       = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;mining&#39;</span><span class="hl-7">, </span><span class="hl-11">options</span><span class="hl-7">);</span><br/><span class="hl-11">tables</span><span class="hl-7">.</span><span class="hl-11">zombie</span><span class="hl-7">       = </span><span class="hl-10">await</span><span class="hl-7"> </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">loadTable</span><span class="hl-7">(</span><span class="hl-9">&#39;monsters/zombie&#39;</span><span class="hl-7">, </span><span class="hl-11">options</span><span class="hl-7">);</span><br/><br/><span class="hl-12">// integrate into your game</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ltm</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">LootTableManager</span><span class="hl-7">();</span><br/><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">setLootTableManager</span><span class="hl-7">(</span><span class="hl-11">ltm</span><span class="hl-7">);</span><br/><span class="hl-11">ltm</span><span class="hl-7">.</span><span class="hl-8">addTables</span><span class="hl-7">(</span><span class="hl-11">tables</span><span class="hl-7">);</span><br/><br/><span class="hl-12">// use it to do monster drops</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">monsterSpawner</span><span class="hl-7"> = </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">createSpawner</span><span class="hl-7">((</span><span class="hl-11">entityManager</span><span class="hl-7">) </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">monster</span><span class="hl-7"> = </span><span class="hl-11">entityManager</span><span class="hl-7">.</span><span class="hl-11">factory</span><span class="hl-7">.</span><span class="hl-8">createMonster</span><span class="hl-7">();</span><br/><span class="hl-7">  </span><span class="hl-11">monster</span><span class="hl-7">.</span><span class="hl-8">addComponent</span><span class="hl-7">(</span><span class="hl-11">Lootable</span><span class="hl-7">);</span><br/><span class="hl-7">  </span><span class="hl-11">monster</span><span class="hl-7">.</span><span class="hl-11">lootable</span><span class="hl-7">.</span><span class="hl-11">table</span><span class="hl-7"> = </span><span class="hl-9">&#39;zombie&#39;</span><span class="hl-7">;</span><br/><span class="hl-7">});</span><br/><br/><span class="hl-12">// or generic loot containers</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">clothesShelf</span><span class="hl-7"> = </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">createLootBox</span><span class="hl-7">().</span><span class="hl-8">set3dModel</span><span class="hl-7">(</span><span class="hl-9">&#39;assets/shelf_full.fbx&#39;</span><span class="hl-7">).</span><span class="hl-8">setTable</span><span class="hl-7">(</span><span class="hl-9">&#39;clothing&#39;</span><span class="hl-7">);</span><br/><br/><span class="hl-12">// or anything</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">block</span><span class="hl-7"> = {</span><br/><span class="hl-7">  </span><span class="hl-11">health:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">loot:</span><span class="hl-7"> </span><span class="hl-11">tables</span><span class="hl-7">.</span><span class="hl-11">mining</span><span class="hl-7">,</span><br/><span class="hl-7">};</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">player</span><span class="hl-7"> = {</span><br/><span class="hl-7">  </span><span class="hl-11">strength:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-8">mine</span><span class="hl-11">:</span><span class="hl-7"> </span><span class="hl-5">async</span><span class="hl-7"> </span><span class="hl-5">function</span><span class="hl-7">(</span><span class="hl-11">block</span><span class="hl-7">) {</span><br/><span class="hl-7">    </span><span class="hl-11">block</span><span class="hl-7">.</span><span class="hl-11">health</span><span class="hl-7"> -= </span><span class="hl-5">this</span><span class="hl-7">.</span><span class="hl-11">strength</span><span class="hl-7">;</span><br/><span class="hl-7">    </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-11">block</span><span class="hl-7">.</span><span class="hl-11">health</span><span class="hl-7"> == </span><span class="hl-13">0</span><span class="hl-7">) {</span><br/><span class="hl-7">      </span><span class="hl-10">return</span><span class="hl-7"> </span><span class="hl-11">block</span><span class="hl-7">.</span><span class="hl-11">loot</span><span class="hl-7">.</span><span class="hl-8">roll</span><span class="hl-7">({</span><span class="hl-11">looter:</span><span class="hl-7"> </span><span class="hl-5">this</span><span class="hl-7">, </span><span class="hl-11">context:</span><span class="hl-7"> </span><span class="hl-11">block</span><span class="hl-7">}).</span><span class="hl-8">then</span><span class="hl-7">(</span><span class="hl-11">loot</span><span class="hl-7"> </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">        </span><span class="hl-11">game</span><span class="hl-7">.</span><span class="hl-8">remove</span><span class="hl-7">(</span><span class="hl-11">block</span><span class="hl-7">);</span><br/><span class="hl-7">        </span><span class="hl-10">return</span><span class="hl-7"> </span><span class="hl-11">loot</span><span class="hl-7">;</span><br/><span class="hl-7">      });</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  }</span><br/><span class="hl-7">};</span><br/><span class="hl-11">player</span><span class="hl-7">.</span><span class="hl-8">mine</span><span class="hl-7">(</span><span class="hl-11">block</span><span class="hl-7">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:functions-and-conditions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Functions and Conditions<a href="#md:functions-and-conditions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Functions can be used to apply effects or modify results on the fly.</p>
<p>Conditions can be used to conditionally stop an item from being added to a roll result.</p>
<p>To allow for storage of loot tables, functions are referenced in loot tables by a name, and registered with either the loot table itself, or UltraLoot instance.</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">miningTable</span><span class="hl-7"> = </span><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">createTable</span><span class="hl-7">({</span><br/><span class="hl-7">  </span><span class="hl-11">name:</span><span class="hl-7"> </span><span class="hl-9">&#39;Mining Table&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [</span><br/><span class="hl-7">    {</span><br/><span class="hl-7">      </span><span class="hl-11">entries:</span><span class="hl-7"> [</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;diamond&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">functions:</span><span class="hl-7"> [</span><br/><span class="hl-7">            {</span><br/><span class="hl-7">              </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;chanceToBreakTool&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">              </span><span class="hl-11">arguments:</span><span class="hl-7"> {</span><br/><span class="hl-7">                </span><span class="hl-11">chance:</span><span class="hl-7"> {</span><br/><span class="hl-7">                  </span><span class="hl-11">n:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">                  </span><span class="hl-11">in:</span><span class="hl-7"> </span><span class="hl-13">10</span><br/><span class="hl-7">                }</span><br/><span class="hl-7">              }</span><br/><span class="hl-7">            }</span><br/><span class="hl-7">          ],</span><br/><span class="hl-7">          </span><span class="hl-11">conditions:</span><span class="hl-7"> [</span><br/><span class="hl-7">            {</span><br/><span class="hl-7">              </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;dependLooterPropertyNumeric&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">              </span><span class="hl-11">arguments:</span><span class="hl-7"> {</span><br/><span class="hl-7">                </span><span class="hl-11">property:</span><span class="hl-7"> </span><span class="hl-9">&#39;experience.level&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">                </span><span class="hl-11">min:</span><span class="hl-7"> </span><span class="hl-13">20</span><br/><span class="hl-7">              }</span><br/><span class="hl-7">            }</span><br/><span class="hl-7">          ]</span><br/><span class="hl-7">        },</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;jellopy&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">functions:</span><span class="hl-7"> [</span><br/><span class="hl-7">            {</span><br/><span class="hl-7">              </span><span class="hl-11">function:</span><span class="hl-7"> </span><span class="hl-9">&#39;chanceToBreakTool&#39;</span><span class="hl-7">,</span><br/><span class="hl-7">              </span><span class="hl-11">arguments:</span><span class="hl-7"> {</span><br/><span class="hl-7">                </span><span class="hl-11">chance:</span><span class="hl-7"> {</span><br/><span class="hl-7">                  </span><span class="hl-11">n:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">                  </span><span class="hl-11">in:</span><span class="hl-7"> </span><span class="hl-13">100</span><br/><span class="hl-7">                }</span><br/><span class="hl-7">              }</span><br/><span class="hl-7">            }</span><br/><span class="hl-7">          ]</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      ]</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  ]</span><br/><span class="hl-7">});</span><br/><br/><span class="hl-12">/**</span><br/><span class="hl-12"> * Simple dot getter function</span><br/><span class="hl-12"> */</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-8">dotGet</span><span class="hl-7"> = (</span><span class="hl-11">ob</span><span class="hl-7">, </span><span class="hl-11">path</span><span class="hl-7">, </span><span class="hl-11">defaultValue</span><span class="hl-7">) </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">result</span><span class="hl-7"> = </span><span class="hl-11">path</span><span class="hl-7">.</span><span class="hl-8">split</span><span class="hl-7">(</span><span class="hl-9">&#39;.&#39;</span><span class="hl-7">).</span><span class="hl-8">reduce</span><span class="hl-7">((</span><span class="hl-11">o</span><span class="hl-7">, </span><span class="hl-11">i</span><span class="hl-7">) </span><span class="hl-5">=&gt;</span><span class="hl-7"> ((</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">o</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) ? </span><span class="hl-11">o</span><span class="hl-7">[</span><span class="hl-11">i</span><span class="hl-7">] : </span><span class="hl-11">o</span><span class="hl-7">), </span><span class="hl-11">ob</span><span class="hl-7">);</span><br/><span class="hl-7">  </span><span class="hl-10">return</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">result</span><span class="hl-7"> === </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7"> ? </span><span class="hl-11">defaultValue</span><span class="hl-7"> : </span><span class="hl-11">result</span><span class="hl-7">);</span><br/><span class="hl-7">};</span><br/><br/><span class="hl-11">miningTable</span><span class="hl-7">.</span><span class="hl-8">registerFunction</span><span class="hl-7">(</span><span class="hl-9">&#39;chanceToBreakTool&#39;</span><span class="hl-7">, ({</span><span class="hl-11">rng</span><span class="hl-7">, </span><span class="hl-11">looter</span><span class="hl-7">, </span><span class="hl-11">args</span><span class="hl-7">}) </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">args</span><span class="hl-7">.</span><span class="hl-11">chance</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) {</span><br/><span class="hl-7">    </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-11">rng</span><span class="hl-7">.</span><span class="hl-8">chance</span><span class="hl-7">(</span><span class="hl-11">chance</span><span class="hl-7">.</span><span class="hl-11">n</span><span class="hl-7"> ?? </span><span class="hl-13">1</span><span class="hl-7">, </span><span class="hl-11">chance</span><span class="hl-7">.</span><span class="hl-11">in</span><span class="hl-7"> ?? </span><span class="hl-13">1</span><span class="hl-7">)) {</span><br/><span class="hl-7">      </span><span class="hl-11">looter</span><span class="hl-7">.</span><span class="hl-11">tool</span><span class="hl-7">.</span><span class="hl-11">broken</span><span class="hl-7"> = </span><span class="hl-5">true</span><span class="hl-7">;</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  }</span><br/><span class="hl-7">});</span><br/><br/><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">registerCondition</span><span class="hl-7">(</span><span class="hl-9">&#39;dependLooterPropertyNumeric&#39;</span><span class="hl-7">, ({</span><span class="hl-11">looter</span><span class="hl-7">, </span><span class="hl-11">args</span><span class="hl-7">}) </span><span class="hl-5">=&gt;</span><span class="hl-7"> {</span><br/><span class="hl-7">  </span><span class="hl-5">const</span><span class="hl-7"> {</span><span class="hl-6">property</span><span class="hl-7">, </span><span class="hl-6">min</span><span class="hl-7">, </span><span class="hl-6">max</span><span class="hl-7">} = </span><span class="hl-11">args</span><span class="hl-7">;</span><br/><span class="hl-7">  </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">property</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) {</span><br/><span class="hl-7">    </span><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">prop</span><span class="hl-7"> = </span><span class="hl-8">dotGet</span><span class="hl-7">(</span><span class="hl-11">looter</span><span class="hl-7">, </span><span class="hl-11">property</span><span class="hl-7">);</span><br/><span class="hl-7">    </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">prop</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) {</span><br/><span class="hl-7">      </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">min</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) {</span><br/><span class="hl-7">        </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-11">prop</span><span class="hl-7"> &lt; </span><span class="hl-11">min</span><span class="hl-7">) {</span><br/><span class="hl-7">          </span><span class="hl-10">return</span><span class="hl-7"> </span><span class="hl-5">false</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      }</span><br/><span class="hl-7">      </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-5">typeof</span><span class="hl-7"> </span><span class="hl-11">max</span><span class="hl-7"> !== </span><span class="hl-9">&#39;undefined&#39;</span><span class="hl-7">) {</span><br/><span class="hl-7">        </span><span class="hl-10">if</span><span class="hl-7"> (</span><span class="hl-11">prop</span><span class="hl-7"> &gt; </span><span class="hl-11">max</span><span class="hl-7">) {</span><br/><span class="hl-7">          </span><span class="hl-10">return</span><span class="hl-7"> </span><span class="hl-5">false</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      }</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  }</span><br/><span class="hl-7">});</span>
</code><button type="button">Copy</button></pre>

<p>Conditions should return a <code>boolean</code> or <code>Promise&lt;boolean&gt;</code>, and functions should not return anything.</p>
<p>There are some handy default functions and conditions that can be registered like so:</p>
<pre><code><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">ul</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">UltraLoot</span><span class="hl-7">();</span><br/><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">registerDefaultFunctions</span><span class="hl-7">();</span><br/><span class="hl-11">ul</span><span class="hl-7">.</span><span class="hl-8">registerDefaultConditions</span><span class="hl-7">();</span>
</code><button>Copy</button></pre>

<p>The <a href="https://manticorp.github.io/ultraloot/code/modules/default_functions.html" target="_blank" class="external">following functions</a> are available:</p>
<pre><code><span class="hl-11">inheritLooter</span><br/><span class="hl-11">inheritContext</span><br/><span class="hl-11">setToRandomChoice</span>
</code><button>Copy</button></pre>

<p>And the <a href="https://manticorp.github.io/ultraloot/code/modules/default_conditions.html" target="_blank" class="external">following conditions</a> are available:</p>
<pre><code><span class="hl-11">dependContext</span><br/><span class="hl-11">dependLooter</span>
</code><button>Copy</button></pre>

<p>For more information, please see the detailed code documentation which lists signatures for these functions.</p>
<a id="md:nesting-tables" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Nesting Tables<a href="#md:nesting-tables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Tables can be nested by either using an existing loot table as an entry, or having an entry whose item property is a loot table.</p>
<pre><code class="javascript"><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">childTable1</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">LootTable</span><span class="hl-7">(</span><span class="hl-11">definition1</span><span class="hl-7">);</span><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">childTable2</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">LootTable</span><span class="hl-7">(</span><span class="hl-11">definition2</span><span class="hl-7">);</span><br/><br/><span class="hl-5">const</span><span class="hl-7"> </span><span class="hl-6">parentTable</span><span class="hl-7"> = </span><span class="hl-5">new</span><span class="hl-7"> </span><span class="hl-8">LootTable</span><span class="hl-7">({</span><br/><span class="hl-7">  </span><span class="hl-11">pools:</span><span class="hl-7"> [</span><br/><span class="hl-7">    {</span><br/><span class="hl-7">      </span><span class="hl-11">entries:</span><span class="hl-7"> [</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">1</span><span class="hl-7">,</span><br/><span class="hl-7">          </span><span class="hl-11">id:</span><span class="hl-7"> </span><span class="hl-9">&#39;regular_item&#39;</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">        </span><span class="hl-11">childTable1</span><span class="hl-7">, </span><span class="hl-12">// will have a weight of 1</span><br/><span class="hl-7">        {</span><br/><span class="hl-7">          </span><span class="hl-11">weight:</span><span class="hl-7"> </span><span class="hl-13">10</span><span class="hl-7">, </span><span class="hl-12">// using this syntax allows us to specify a weight</span><br/><span class="hl-7">          </span><span class="hl-11">item:</span><span class="hl-7"> </span><span class="hl-11">childTable2</span><br/><span class="hl-7">        }</span><br/><span class="hl-7">      ]</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  ]</span><br/><span class="hl-7">})</span>
</code><button type="button">Copy</button></pre>

<a id="md:examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Examples<a href="#md:examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>There are numerous examples in the docs/examples folder - I encourage you to explore!</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:ultraloot"><span>Ultra<wbr/>Loot</span></a><ul><li><a href="#md:installation"><span>Installation</span></a></li><li><ul><li><a href="#md:browser"><span>Browser</span></a></li><li><a href="#md:node"><span>Node</span></a></li><li><a href="#md:es-module"><span>ES <wbr/>Module</span></a></li></ul></li><li><a href="#md:use-cases"><span>Use cases</span></a></li><li><a href="#md:preface"><span>Preface</span></a></li><li><a href="#md:structure"><span>Structure</span></a></li><li><ul><li><a href="#md:chancy"><span>Chancy</span></a></li></ul></li><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:simple"><span>Simple</span></a></li><li><a href="#md:handing-results"><span>Handing <wbr/>Results</span></a></li><li><a href="#md:sync-vs-async"><span>Sync vs <wbr/>Async</span></a></li><li><a href="#md:loading-from-json-files"><span>Loading from JSON files</span></a></li><li><a href="#md:functions-and-conditions"><span>Functions and <wbr/>Conditions</span></a></li><li><a href="#md:nesting-tables"><span>Nesting <wbr/>Tables</span></a></li></ul></li><li><a href="#md:examples"><span>Examples</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@manticorp/ultraloot</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
